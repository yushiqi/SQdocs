

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10.1 常见加密算法 &mdash; 世奇笔记 V1.0.0 文档</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="第十一章：数据可视化" href="../chapters/11keshihua.html" />
    <link rel="prev" title="第十章：数据结构与算法" href="../chapters/10suanfa.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> 世奇笔记
          

          
          </a>

          
            
            
              <div class="version">
                V1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../preface.html">前言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/01jichu.html">第一章：Python基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/02gaoji.html">第二章：高级编程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/03yibu.html">第三章：异步IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/04web.html">第四章：Web开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/05fenxi.html">第五章：数据分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/06gongju.html">第六章：开发工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/07linux.html">第七章：Linux笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/08net.html">第八章：网络基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/09keng.html">第九章：踩坑记录</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../chapters/10suanfa.html">第十章：数据结构与算法</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">10.1 常见加密算法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">1. 常见加密算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">2. 单向散列加密</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#md5">2.1 MD5加密算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sha1">2.2 SHA1加密算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sha256">2.3 SHA256加密算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id5">3. 对称加密算法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#aes">3.1 AES算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#des">3.2 DES算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#des-1">3.3 3DES算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">4. 非对称加密算法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsa">4.1 RSA算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ecc">4.3 ECC算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">5.常见加密算法对比</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">5.1 单向散列加密算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">5.2 对称加密算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">5.3 非对称加密算法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/11keshihua.html">第十一章：数据可视化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutme.html">关于作者</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">世奇笔记</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../chapters/10suanfa.html">第十章：数据结构与算法</a> &raquo;</li>
        
      <li>10.1 常见加密算法</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/c10/01常见加密算法.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>10.1 常见加密算法<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>利用加密算法来对数据通信的过程进行加密传输是一种最常见的安全手段。通常利用这一手段能够达到以下三个目的：</p>
<ul class="simple">
<li><p>数据保密性，防止用户数据被窃取或泄露</p></li>
<li><p>数据完整性，防止用户传输的数据被篡改</p></li>
<li><p>通信双方身份确认，确保数据来源合法</p></li>
</ul>
<div class="section" id="id2">
<span id="id3"></span><h2>1. 常见加密算法<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>常见的加密算法分类如下：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>分类</p></th>
<th class="head"><p>示例</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>单向散列加密算法</p></td>
<td><p>MD5、sha1、sha256</p></td>
</tr>
<tr class="row-odd"><td><p>对称加密算法</p></td>
<td><p>DES、3DES、AES</p></td>
</tr>
<tr class="row-even"><td><p>非对称加密算法</p></td>
<td><p>RSA、ECC</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id4">
<h2>2. 单向散列加密<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>单向散列加密算法常用于提取数据，验证数据的完整性。发送者将明文通过单向加密算法加密生成定长的密文串，然后将明文和密文串传递给接收方。接收方在收到报文后，将解明文使用相同的单向加密算法进行加密，得出加密后的密文串。随后与发送者发送过来的密文串进行对比，若发送前和发送后的密文串相一致，则说明传输过程中数据没有损坏；若不一致，说明传输过程中数据丢失了。其次也用于密码加密传递存储。单向加密算法只能用于对数据的加密，无法被解密，其特点为<strong>定长输出</strong>、<strong>雪崩效应</strong>。</p>
<div class="section" id="md5">
<h3>2.1 MD5加密算法<a class="headerlink" href="#md5" title="永久链接至标题">¶</a></h3>
<p>MD5加密算法用的是哈希函数，一般应用于对信息产生信息摘要，防止信息被篡改。最常见的使用是对密码加密、生成数字签名。从严格意义上来说，MD5是摘要算法，并非加密算法。MD5
生成密文时，无论要加密的字符串有多长，它都会输出长度为 128bits
的一个密文串，通常16 进制时为 32 个字符。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="sha1">
<h3>2.2 SHA1加密算法<a class="headerlink" href="#sha1" title="永久链接至标题">¶</a></h3>
<p>SHA1加密算法，与MD5一样，也是目前较流行的摘要算法。但SHA1 比 MD5 的
安全性更高。对长度小于 2 ^ 64 位的消息，SHA1会产生一个 160
位的消息摘要。基于 MD5、SHA1
的信息摘要特性以及不可逆，可以被应用在检查文件完整性， 数字签名等场景。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="n">sha1</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>   <span class="c1">#转码（字节流）</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sha1</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>        <span class="c1">#将字节码转成16进制</span>
</pre></div>
</div>
</div>
<div class="section" id="sha256">
<h3>2.3 SHA256加密算法<a class="headerlink" href="#sha256" title="永久链接至标题">¶</a></h3>
<p>SHA256是SHA2算法中的一种，如SHA2加密算法中有：SHA244、SHA256、SHA512等。SHA2属于SHA1的升级，SHA1是160位的哈希值，而SHA2是组合值，有不同的位数，其中最受欢迎的是256位（SHA256算法）。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="n">sha256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>   <span class="c1"># 转码（字节流）</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sha256</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>        <span class="c1"># 将字节码转成16进制</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id5">
<h2>3. 对称加密算法<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>对称加密算法采用单密钥加密，在数据传输过程中，发送方将原始数据分割成固定大小的块，经过密钥和加密算法逐个加密后，发送给接收方；接收方收到加密后的报文后，结合密钥和解密算法解密组合后得出原始数据。由于加解密算法是公开的，因此在这过程中，密钥的安全传递就成为了至关重要的事了。而密钥通常来说是通过双方协商，以物理的方式传递给对方，或者利用第三方平台传递给对方，一旦这过程出现了密钥泄露，不怀好意的人就能结合相应的算法拦截解密出其加密传输的内容。</p>
<p>AES、DES、3DES 都是对称的块加密算法，加解密的过程是可逆的。</p>
<div class="section" id="aes">
<h3>3.1 AES算法<a class="headerlink" href="#aes" title="永久链接至标题">¶</a></h3>
<p>AES算法是密码学中的高级加密标准，同时也是美国联邦政府采用的区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。算法采用对称分组密码体制，密钥长度的最少支持为
128 位、 192 位、256 位，分组长度 128
位，算法应易于各种硬件和软件实现。AES本身就是为了取代DES的，AES具有更好的安全性、效率和灵活性。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="c1">#python3 安装 Crypto pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pycryptodome</span>

<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AES 解密</span>
<span class="sd">    :param data: 原始字符串</span>
<span class="sd">    :param key: 密钥</span>
<span class="sd">    :return: 加密后字符串，16进制</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>  <span class="c1"># 初始化加密器</span>
        <span class="n">decrypted_text</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">decodebytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>  <span class="c1"># 解密</span>
        <span class="n">decrypted_text</span> <span class="o">=</span> <span class="n">decrypted_text</span><span class="p">[:</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="n">decrypted_text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>  <span class="c1"># 去除多余补位</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">decrypted_text</span>

<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AES 加密</span>
<span class="sd">    :param data: 加密后的字符串，16进制</span>
<span class="sd">    :param key: 密钥</span>
<span class="sd">    :return:  解密后的字符串</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>     <span class="c1"># 补足字符串长度为16的倍数</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>  <span class="c1"># 初始化加密器</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">encodebytes</span><span class="p">(</span><span class="n">aes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;elf2d;_3&amp;sd2sw,2&#39;</span>  <span class="c1"># 密钥长度必须为16、24或32位，分别对应AES-128、AES-192和AES-256</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;hello world&quot;</span>    <span class="c1"># 待加密文本</span>

    <span class="n">cipher</span> <span class="o">=</span> <span class="n">encode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;加密值：&quot;</span><span class="p">,</span><span class="n">cipher</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;解密值：&quot;</span><span class="p">,</span><span class="n">decode</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="des">
<h3>3.2 DES算法<a class="headerlink" href="#des" title="永久链接至标题">¶</a></h3>
<p>DES算法为密码体制中的对称密码体制，又被称为美国数据加密标准，是1972年美国IBM公司研制的对称密码体制加密算法。明文按64位进行分组，密钥长64位，密钥事实上是56位参与DES运算（第8、16、24、32、40、48、56、64位是校验位，
使得每个密钥都有奇数个1）分组后的明文组和56位的密钥按位替代或交换的方法形成密文组的加密方法。</p>
<p>DES
加密算法是对密钥进行保密，公开加密和解密算。只有知道发送方相同密钥的人才能解读获取的密文数据。想破译
DES
加密算法，就要搜索密钥的编码。对于56位长度的密钥来说，用穷举法，其运算次数为
2 ^ 56 次。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyDes</span> <span class="kn">import</span> <span class="n">des</span><span class="p">,</span> <span class="n">CBC</span><span class="p">,</span> <span class="n">PAD_PKCS5</span>
<span class="kn">import</span> <span class="nn">binascii</span>
 <span class="c1"># pip install pyDes</span>

<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DES 加密</span>
<span class="sd">    :param s: 原始字符串</span>
<span class="sd">    :param secret_key: 密钥</span>
<span class="sd">    :return: 加密后字符串，16进制</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">secret_key</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">des</span><span class="p">(</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">padmode</span><span class="o">=</span><span class="n">PAD_PKCS5</span><span class="p">)</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">padmode</span><span class="o">=</span><span class="n">PAD_PKCS5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DES 解密</span>
<span class="sd">    :param s: 加密后的字符串，16进制</span>
<span class="sd">    :param secret_key: 密钥</span>
<span class="sd">    :return:  解密后的字符串</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">secret_key</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">des</span><span class="p">(</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">padmode</span><span class="o">=</span><span class="n">PAD_PKCS5</span><span class="p">)</span>
    <span class="n">de</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">a2b_hex</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">padmode</span><span class="o">=</span><span class="n">PAD_PKCS5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">de</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;drfocmnf&#39;</span>  <span class="c1"># 密钥长度必须为8</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;hello world&quot;</span>    <span class="c1"># 待加密文本</span>

    <span class="n">cipher</span> <span class="o">=</span> <span class="n">encode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;加密值：&quot;</span><span class="p">,</span><span class="n">cipher</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;解密值：&quot;</span><span class="p">,</span><span class="n">decode</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="des-1">
<span id="id6"></span><h3>3.3 3DES算法<a class="headerlink" href="#des-1" title="永久链接至标题">¶</a></h3>
<p>3DES又称Triple
DES，是DES加密算法的一种模式，它使用2条不同的56位的密钥对数据进行三次加密。DES使用56位密钥和密码块的方法，而在密码块的方法中，文本被分成64位大小的文本块然后再进行加密。比起最初的DES，3DES更为安全。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span><span class="p">;</span>

<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">DES3</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="k">def</span> <span class="nf">create_key</span><span class="p">(</span><span class="n">sk</span><span class="p">):</span>

    <span class="n">r</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">+</span><span class="n">r</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">init_str</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span>
    <span class="k">if</span> <span class="n">l</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">c</span><span class="o">=</span><span class="mi">16</span><span class="o">-</span><span class="n">l</span>
        <span class="n">s</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
    <span class="k">return</span> <span class="n">s</span>



<span class="n">key</span><span class="o">=</span><span class="s1">&#39;ewfff&#39;</span><span class="c1">#秘钥</span>
<span class="n">keys</span><span class="o">=</span><span class="n">create_key</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

<span class="n">ss</span><span class="o">=</span><span class="n">init_str</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">)</span>
<span class="n">des3</span><span class="o">=</span><span class="n">DES3</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">DES3</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<span class="n">res2</span><span class="o">=</span><span class="n">des3</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
<span class="n">b2bencryptkey</span><span class="o">=</span>  <span class="n">base64</span><span class="o">.</span><span class="n">standard_b64encode</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b2bencryptkey</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>4. 非对称加密算法<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="section" id="rsa">
<h3>4.1 RSA算法<a class="headerlink" href="#rsa" title="永久链接至标题">¶</a></h3>
<p>RSA是目前最有影响力的公钥加密算法，也是被普遍认为是目前最优秀的公钥方案之一。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rsa</span>


<span class="c1"># rsa加密</span>
<span class="k">def</span> <span class="nf">rsaEncrypt</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="c1"># 生成公钥、私钥</span>
    <span class="p">(</span><span class="n">pubkey</span><span class="p">,</span> <span class="n">privkey</span><span class="p">)</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">newkeys</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;公钥:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">私钥:</span><span class="se">\n</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pubkey</span><span class="p">,</span> <span class="n">privkey</span><span class="p">))</span>
    <span class="c1"># 明文编码格式</span>
    <span class="n">content</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="c1"># 公钥加密</span>
    <span class="n">crypto</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">crypto</span><span class="p">,</span> <span class="n">privkey</span><span class="p">)</span>


<span class="c1"># rsa解密</span>
<span class="k">def</span> <span class="nf">rsaDecrypt</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
    <span class="c1"># 私钥解密</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">)</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">con</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">str</span><span class="p">,</span> <span class="n">pk</span> <span class="o">=</span> <span class="n">rsaEncrypt</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;加密后密文：</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">rsaDecrypt</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;解密后明文：</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ecc">
<h3>4.3 ECC算法<a class="headerlink" href="#ecc" title="永久链接至标题">¶</a></h3>
<p>ECC（椭圆加密算法）是一种公钥加密体制，主要优势是在某些情况下它比其他的方法使用更小的密钥（比如RSA加密算法）提供相当的或更高等级的安全。不过一个缺点是加密和解密操作的实现比其他机制时间长。它相比RSA算法，对
CPU 消耗严重。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    考虑K=kG ，其中K、G为椭圆曲线Ep(a,b)上的点，n为G的阶（nG=O∞ ），k为小于n的整数。</span>
<span class="sd">    则给定k和G，根据加法法则，计算K很容易但反过来，给定K和G，求k就非常困难。</span>
<span class="sd">    因为实际使用中的ECC原则上把p取得相当大，n也相当大，要把n个解点逐一算出来列成上表是不可能的。</span>
<span class="sd">    这就是椭圆曲线加密算法的数学依据</span>

<span class="sd">    点G称为基点（base point）</span>

<span class="sd">    k（k&lt;n）为私有密钥（privte key）</span>

<span class="sd">    K为公开密钥（public key)</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">get_inverse</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取y的负元</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">mu</span><span class="p">)</span><span class="o">%</span><span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>


<span class="k">def</span> <span class="nf">get_gcd</span><span class="p">(</span><span class="n">zi</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取最大公约数</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mu</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_gcd</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">zi</span><span class="o">%</span><span class="n">mu</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">zi</span>


<span class="k">def</span> <span class="nf">get_np</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取n*p，每次+p，直到求解阶数np=-p</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 定义符号位（+/-）</span>

    <span class="c1"># 如果 p=q  k=(3x2+a)/2y1mod p</span>
    <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="ow">and</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
        <span class="n">zi</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>  <span class="c1"># 计算分子      【求导】</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1</span>    <span class="c1"># 计算分母</span>

    <span class="c1"># 若P≠Q，则k=(y2-y1)/(x2-x1) mod p</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zi</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span>
        <span class="k">if</span> <span class="n">zi</span><span class="o">*</span> <span class="n">mu</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># 符号0为-（负数）</span>
            <span class="n">zi</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zi</span><span class="p">)</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># 将分子和分母化为最简</span>
    <span class="n">gcd_value</span> <span class="o">=</span> <span class="n">get_gcd</span><span class="p">(</span><span class="n">zi</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>     <span class="c1"># 最大公約數</span>
    <span class="n">zi</span> <span class="o">=</span> <span class="n">zi</span> <span class="o">//</span> <span class="n">gcd_value</span>            <span class="c1"># 整除</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">//</span> <span class="n">gcd_value</span>
    <span class="c1"># 求分母的逆元  逆元： ∀a ∈G ，ョb∈G 使得 ab = ba = e</span>
    <span class="c1"># P(x,y)的负元是 (x,-y mod p)= (x,p-y) ，有P+(-P)= O∞</span>
    <span class="n">inverse_value</span> <span class="o">=</span> <span class="n">get_inverse</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">zi</span> <span class="o">*</span> <span class="n">inverse_value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>                   <span class="c1"># 斜率负数 flag==0</span>
        <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">%</span> <span class="n">p</span>
    <span class="c1"># 计算x3,y3 P+Q</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        x3≡k2-x1-x2(mod p)</span>
<span class="sd">        y3≡k(x1-x3)-y1(mod p)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x3</span><span class="p">)</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">x3</span><span class="p">,</span><span class="n">y3</span>


<span class="k">def</span> <span class="nf">get_rank</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取椭圆曲线的阶</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span>             <span class="c1">#-p的x坐标</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">y0</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>      <span class="c1">#-p的y坐标</span>
    <span class="n">tempX</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">tempY</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># 求p+q的和，得到n*p，直到求出阶</span>
        <span class="n">p_x</span><span class="p">,</span><span class="n">p_y</span> <span class="o">=</span> <span class="n">get_np</span><span class="p">(</span><span class="n">tempX</span><span class="p">,</span> <span class="n">tempY</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="c1"># 如果 == -p,那么阶数+1，返回</span>
        <span class="k">if</span> <span class="n">p_x</span> <span class="o">==</span> <span class="n">x1</span> <span class="ow">and</span> <span class="n">p_y</span> <span class="o">==</span> <span class="n">y1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">tempX</span> <span class="o">=</span> <span class="n">p_x</span>
        <span class="n">tempY</span> <span class="o">=</span> <span class="n">p_y</span>


<span class="k">def</span> <span class="nf">get_param</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    计算p与-p</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="c1"># 满足取模约束条件，椭圆曲线Ep(a,b)，p为质数，x,y∈[0,p-1]</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="o">%</span><span class="n">p</span> <span class="o">==</span> <span class="p">(</span><span class="n">x0</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x0</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">p</span><span class="p">:</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>

    <span class="c1"># 如果y0没有，返回false</span>
    <span class="k">if</span> <span class="n">y0</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># 计算-y（负数取模）</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">y0</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span>


<span class="k">def</span> <span class="nf">get_graph</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    输出椭圆曲线散点图</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># 初始化二维数组</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">x_y</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;-&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span><span class="n">get_param</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># 椭圆曲线上的点</span>
        <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">val</span>
            <span class="n">x_y</span><span class="p">[</span><span class="n">x0</span><span class="p">][</span><span class="n">y0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x_y</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;椭圆曲线的散列图为：&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>              <span class="c1"># i= 0-&gt; p-1</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span>        <span class="c1"># 倒序</span>

        <span class="c1"># 格式化输出1/2位数，y坐标轴</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>

        <span class="c1"># 输出具体坐标的值，一行</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x_y</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">temp</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1">#换行</span>

    <span class="c1"># 输出 x 坐标轴</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span><span class="mi">10</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_ng</span><span class="p">(</span><span class="n">G_x</span><span class="p">,</span> <span class="n">G_y</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    计算nG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp_x</span> <span class="o">=</span> <span class="n">G_x</span>
    <span class="n">temp_y</span> <span class="o">=</span> <span class="n">G_y</span>
    <span class="k">while</span> <span class="n">key</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">temp_x</span><span class="p">,</span><span class="n">temp_y</span> <span class="o">=</span> <span class="n">get_np</span><span class="p">(</span><span class="n">temp_x</span><span class="p">,</span><span class="n">temp_y</span><span class="p">,</span> <span class="n">G_x</span><span class="p">,</span> <span class="n">G_y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">temp_x</span><span class="p">,</span><span class="n">temp_y</span>


<span class="k">def</span> <span class="nf">ecc_main</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;请输入椭圆曲线参数a(a&gt;0)的值：&quot;</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;请输入椭圆曲线参数b(b&gt;0)的值：&quot;</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;请输入椭圆曲线参数p(p为素数)的值：&quot;</span><span class="p">))</span>   <span class="c1">#用作模运算</span>

        <span class="c1"># 条件满足判断</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">%</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;您输入的参数有误，请重新输入！！！</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># 输出椭圆曲线散点图</span>
    <span class="n">get_graph</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># 选点作为G点</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user1：在如上坐标系中选一个值为G的坐标&quot;</span><span class="p">)</span>
    <span class="n">G_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;user1：请输入选取的x坐标值：&quot;</span><span class="p">))</span>
    <span class="n">G_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;user1：请输入选取的y坐标值：&quot;</span><span class="p">))</span>

    <span class="c1"># 获取椭圆曲线的阶</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">get_rank</span><span class="p">(</span><span class="n">G_x</span><span class="p">,</span> <span class="n">G_y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># user1生成私钥，小key</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;user1：请输入私钥小key（&lt;</span><span class="si">{}</span><span class="s2">）：&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>

    <span class="c1"># user1生成公钥，大KEY</span>
    <span class="n">KEY_x</span><span class="p">,</span><span class="n">kEY_y</span> <span class="o">=</span> <span class="n">get_ng</span><span class="p">(</span><span class="n">G_x</span><span class="p">,</span> <span class="n">G_y</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># user2阶段</span>
    <span class="c1"># user2拿到user1的公钥KEY，Ep(a,b)阶n，加密需要加密的明文数据</span>
    <span class="c1"># 加密准备</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;user2：请输入一个整数k（&lt;</span><span class="si">{}</span><span class="s2">）用于求kG和kQ：&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="n">k_G_x</span><span class="p">,</span><span class="n">k_G_y</span> <span class="o">=</span> <span class="n">get_ng</span><span class="p">(</span><span class="n">G_x</span><span class="p">,</span> <span class="n">G_y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>                         <span class="c1"># kG</span>
    <span class="n">k_Q_x</span><span class="p">,</span><span class="n">k_Q_y</span> <span class="o">=</span> <span class="n">get_ng</span><span class="p">(</span><span class="n">KEY_x</span><span class="p">,</span> <span class="n">kEY_y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>                     <span class="c1"># kQ</span>

    <span class="c1"># 加密</span>
    <span class="n">plain_text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;user2：请输入需要加密的字符串:&quot;</span><span class="p">)</span>
    <span class="n">plain_text</span> <span class="o">=</span> <span class="n">plain_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1">#plain_text = int(input(&quot;user1：请输入需要加密的密文：&quot;))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;密文为：&quot;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">plain_text</span><span class="p">:</span>
        <span class="n">intchar</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="n">cipher_text</span> <span class="o">=</span> <span class="n">intchar</span><span class="o">*</span><span class="n">k_Q_x</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k_G_x</span><span class="p">,</span> <span class="n">k_G_y</span><span class="p">,</span> <span class="n">cipher_text</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">),</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_G_x</span><span class="p">,</span> <span class="n">k_G_y</span><span class="p">,</span> <span class="n">cipher_text</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>


    <span class="c1"># user1阶段</span>
    <span class="c1"># 拿到user2加密的数据进行解密</span>
    <span class="c1"># 知道 k_G_x,k_G_y，key情况下，求解k_Q_x,k_Q_y是容易的，然后plain_text = cipher_text/k_Q_x</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">user1解密得到明文：&quot;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">charArr</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">decrypto_text_x</span><span class="p">,</span><span class="n">decrypto_text_y</span> <span class="o">=</span> <span class="n">get_ng</span><span class="p">(</span><span class="n">charArr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">charArr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">charArr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">//</span><span class="n">decrypto_text_x</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ecc_main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id8">
<h2>5.常见加密算法对比<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<div class="section" id="id9">
<h3>5.1 单向散列加密算法<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 38%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>名称</p></th>
<th class="head"><p>运行速度</p></th>
<th class="head"><p>安全性</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MD5</p></td>
<td><p>快</p></td>
<td><p>中</p></td>
</tr>
<tr class="row-odd"><td><p>SHA1</p></td>
<td><p>慢</p></td>
<td><p>高</p></td>
</tr>
<tr class="row-even"><td><p>SHA256</p></td>
<td><p>更慢</p></td>
<td><p>更高</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id10">
<span id="id11"></span><h3>5.2 对称加密算法<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 33%" />
<col style="width: 20%" />
<col style="width: 16%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>名称</p></th>
<th class="head"><p>密钥</p></th>
<th class="head"><p>运行速度</p></th>
<th class="head"><p>安全性</p></th>
<th class="head"><p>资源消耗</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DES</p></td>
<td><p>56位</p></td>
<td><p>较快</p></td>
<td><p>低</p></td>
<td><p>中</p></td>
</tr>
<tr class="row-odd"><td><p>3DES</p></td>
<td><p>112位或168位</p></td>
<td><p>慢</p></td>
<td><p>中</p></td>
<td><p>高</p></td>
</tr>
<tr class="row-even"><td><p>AES</p></td>
<td><p>128、192、256位</p></td>
<td><p>快</p></td>
<td><p>高</p></td>
<td><p>低</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id12">
<span id="id13"></span><h3>5.3 非对称加密算法<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>名称</p></th>
<th class="head"><p>成熟度</p></th>
<th class="head"><p>安全性</p></th>
<th class="head"><p>运算速度</p></th>
<th class="head"><p>资源消耗</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RSA</p></td>
<td><p>高</p></td>
<td><p>高</p></td>
<td><p>中</p></td>
<td><p>中</p></td>
</tr>
<tr class="row-odd"><td><p>ECC</p></td>
<td><p>高</p></td>
<td><p>高</p></td>
<td><p>慢</p></td>
<td><p>高</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../chapters/11keshihua.html" class="btn btn-neutral float-right" title="第十一章：数据可视化" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../chapters/10suanfa.html" class="btn btn-neutral float-left" title="第十章：数据结构与算法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; 版权所有 2020, yushiqi

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>